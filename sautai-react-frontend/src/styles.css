/* Plans table */
.plans-table{ width:100%; border-collapse:separate; border-spacing:0; }
.plans-table th, .plans-table td{ border-bottom:1px solid var(--border); padding:.6rem .7rem; text-align:left; vertical-align:top }
.plans-table thead th{ background:#FAFCFA; position:sticky; top:0; z-index:1 }
.plans-table .col-day{ width:110px; color:var(--primary-700); font-weight:800 }
.plans-table .col-type{ width:120px; font-weight:700 }
.plans-table .col-name{ width:260px }
.plans-table .col-desc{ }
.plans-table .col-actions{ width:100px }
.desc-clamp{ color:var(--muted); display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; text-overflow:ellipsis; max-height:2.8em }
.desc-clamp.expanded{ -webkit-line-clamp:unset; max-height:none }
.btn-link{ background:transparent; border:0; color:var(--link); cursor:pointer; font-size:.9rem; padding:0; margin-top:.15rem }
.btn-sm{ padding:.35rem .6rem; font-size:.9rem }
/* Design tokens */
:root{
  --primary:#5cb85c;
  --primary-600:#4AA74A;
  --primary-700:#3E8F3E;
  --text:#263328;
  --muted:#5c6b5d;
  --bg:#FFFFFF;
  --bg2:#F8FAF7;
  --link:#3F7A35;
  --border:#E4ECE4;
  --radius:12px;
  --radius-lg:16px;
  --radius-xl:22px;

  --shadow-xs: 0 1px 2px rgba(16, 24, 16, 0.05);
  --shadow-sm: 0 2px 8px rgba(16, 24, 16, 0.08);
  --shadow-md: 0 8px 24px rgba(16, 24, 16, 0.12);

  --gradient-brand: linear-gradient(90deg, #5cb85c 0%, #4AA74A 50%, #3E8F3E 100%);
}

*{box-sizing:border-box}
html,body,#root{ height:100% }
body{
  margin:0;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Inter, Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
  background:var(--bg);
  color:var(--text);
  font-size:16px; line-height:1.55;
}

/* Links */
a{ color:var(--link); text-decoration:underline }
a.btn{ text-decoration:none }

/* Layout */
.container{ max-width:1180px; margin:0 auto; padding:1rem }

/* Navbar - glassy, modern */
.navbar{ position:sticky; top:0; z-index:20; backdrop-filter:saturate(180%) blur(10px);
  background:color-mix(in oklab, white 92%, transparent);
  border-bottom:1px solid color-mix(in oklab, var(--border) 80%, transparent);
  box-shadow: var(--shadow-xs);
}
.navbar-inner{ display:flex; align-items:center; gap:.75rem; padding:.6rem 1rem }
.brand{ display:flex; align-items:center; gap:.5rem; font-weight:800; font-size:1.125rem }
.nav-links{ margin-left:auto; display:flex; gap:.5rem; flex-wrap:wrap }

/* Force-hide hamburger on wide screens */
.navbar .menu-toggle{ display:none !important }

/* Responsive menu */
.menu-toggle{ align-items:center; justify-content:center }
.menu-toggle svg{ transition: transform .2s ease }
.menu-toggle.open svg{ transform: rotate(90deg) }
@media (max-width: 860px){
  .navbar .menu-toggle{ display:inline-flex !important; margin-left:auto }
  .nav-links{ position:absolute; right:1rem; top:64px; background:#fff; border:1px solid var(--border); border-radius:14px; box-shadow: var(--shadow-md); padding:.6rem; display:none; flex-direction:column; gap:.4rem; min-width: 220px }
  .nav-links.open{ display:flex }
  .navbar-inner{ position:relative }
}

/* Buttons */
.btn{ display:inline-flex; align-items:center; justify-content:center; gap:.4rem;
  padding:.6rem .95rem; border-radius:9999px; border:1px solid transparent; font-weight:700; cursor:pointer;
  transition: transform .15s ease, box-shadow .15s ease, background-color .15s ease, border-color .15s ease;
}
.btn:focus{ outline:none; box-shadow:0 0 0 3px rgba(92,184,92,0.25) }
.btn:active{ transform: translateY(1px) }
.btn-primary{ color:white; background:var(--gradient-brand); box-shadow: var(--shadow-sm) }
.btn-primary:hover{ filter:brightness(0.98) }
.btn-outline{ background:transparent; border-color: color-mix(in oklab, var(--border) 70%, transparent); color:var(--text) }
.btn-outline:hover{ background: color-mix(in oklab, var(--primary) 6%, white 94%); border-color: color-mix(in oklab, var(--primary) 30%, var(--border)) }
.btn-danger{ background:#d9534f; color:white }

/* Inputs */
.input, .select, .textarea{ width:100%; padding:.65rem .75rem; border:1px solid var(--border); border-radius:12px; background:#fff; color:var(--text) }
.label{ font-weight:600; margin:.5rem 0 .25rem }

/* Surfaces & Cards */
.card{ background:#fff; border:1px solid color-mix(in oklab, var(--border) 90%, transparent); border-radius:var(--radius-lg); padding:1rem; box-shadow: var(--shadow-xs) }
.card:hover{ box-shadow: var(--shadow-sm) }

/* Grids */
.grid{ display:grid; gap:1rem }
.grid-2{ grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)) }
.grid-3{ grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)) }

/* Tables, Footer */
.table{ width:100%; border-collapse: collapse }
.table th, .table td{ border:1px solid var(--border); padding:.5rem .6rem; text-align:left }
.table th{ background:#F0F6F0 }
.footer{ margin-top:2rem; padding:1rem; border-top:1px solid var(--border); text-align:center; font-size:.9rem }

/* Legacy hero (kept minimal) */
.hero{ padding:2rem 1rem; text-align:center; background:var(--bg2); border-bottom:1px solid var(--border) }
.hero h1{ font-size:2rem; margin:.25rem 0 }
.hero p{ color:#3A4A3A }

/* Home page scoped enhancements */
.page-home{ --surface:#ffffff }
.page-home .section{ padding: 2.5rem 0 }
.page-home .section-title{ text-align:center; margin:0 0 .5rem; font-size:1.6rem; letter-spacing:.2px }
.page-home .section-sub{ text-align:center; margin:0 auto 1rem; max-width:60ch; color:var(--muted) }
.page-home .divider{ height:1px; background:var(--border); margin:1.5rem 0 }

/* Modern hero */
.page-home .hero{ background: radial-gradient(1200px 300px at 20% -10%, rgba(92,184,92,0.12), transparent 40%), linear-gradient(180deg, #FAFCFA 0%, #FFFFFF 100%);
  border:1px solid var(--border); border-radius:var(--radius-xl); padding:1.5rem; box-shadow: var(--shadow-sm) }
.page-home .hero-split{ display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:1.5rem; align-items:center }
.page-home .eyebrow{ text-transform:uppercase; font-weight:700; font-size:.8rem; color:var(--primary-700); letter-spacing:.08em; margin-bottom:.25rem }
.page-home .display{ font-size:2.4rem; line-height:1.1; margin:.25rem 0 }
.page-home .text-gradient{ background: var(--gradient-brand); -webkit-background-clip:text; background-clip:text; color:transparent }
.page-home .hero-actions{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:.9rem }
.page-home .image-rounded{ border-radius:18px; border:1px solid var(--border); box-shadow: var(--shadow-sm); width:100%; height:auto; display:block }

/* Intro cards */
.page-home .intro-cards{ display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:1rem }
.page-home .intro-cards .card p{ color:var(--muted) }

/* Feature media blocks */
.page-home .media{ display:grid; grid-template-columns: repeat(12, 1fr); gap:1.25rem; align-items:center; margin:1.25rem 0 }
.page-home .media .media-image{ grid-column: span 6 }
.page-home .media .media-body{ grid-column: span 6 }
.page-home .media.reverse .media-image{ order:2 }
@media (max-width: 820px){
  .page-home .media{ grid-template-columns: 1fr }
  .page-home .media .media-image, .page-home .media .media-body{ grid-column: auto; order: initial }
}
.page-home .list{ margin:.4rem 0 0 1.1rem; color:var(--muted) }
.page-home .list li{ margin:.3rem 0 }

/* Steps */
.page-home .steps-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:1rem }
.page-home .step{ display:flex; gap:.75rem; align-items:flex-start }
.page-home .step .num{ width:34px; height:34px; border-radius:999px; background: color-mix(in oklab, var(--primary) 14%, white); color:var(--primary-700); display:flex; align-items:center; justify-content:center; font-weight:800 }

/* CTA */
.page-home .cta{ display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:1rem; align-items:center }
.page-home .cta .actions{ display:flex; flex-direction:column; gap:.6rem }

/* Navbar button tone adjustments */
.navbar .btn-outline{ border-color:transparent; background:transparent }
.navbar .btn-outline:hover{ background: color-mix(in oklab, var(--primary) 8%, white 92%) }

/* Meal Plans page */
.page-plans .plans-header{ display:flex; gap:1rem; align-items:center; justify-content:space-between; padding:1rem; margin-bottom:1rem }
.page-plans .plans-header .left .sub{ color:var(--muted) }
.page-plans .plans-header .right{ display:flex; gap:.75rem; align-items:center; flex-wrap:wrap; justify-content:flex-end; width:100% }
.page-plans .plans-header .controls{ display:flex; gap:.5rem; flex-wrap:wrap }
.page-plans .plans-header .tabs{ display:flex; gap:.4rem; flex-wrap:wrap }
.page-plans .plans-header .tabs .tab{ border:1px solid var(--border); background:#fff; color:var(--text); padding:.45rem .75rem; border-radius:999px; cursor:pointer; font-weight:600 }
.page-plans .plans-header .tabs .tab.active{ background:var(--primary); color:#fff; border-color:transparent }

.page-plans .days-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:1rem }
.page-plans .day{ padding:0 }
.page-plans .day .day-head{ padding: .9rem 1rem .4rem; border-bottom:1px solid var(--border) }
.page-plans .day .day-body{ padding: .75rem 1rem }
.page-plans .meal-row{ display:grid; grid-template-columns: 100px 1fr; gap:.5rem; padding:.35rem 0; align-items:baseline }
.page-plans .meal-row + .meal-row{ border-top:1px dashed var(--border) }
.page-plans .meal-row.replacing{ position:relative }
.page-plans .meal-row.replacing::after{ content:""; position:absolute; inset:0; background:linear-gradient(90deg, rgba(92,184,92,.08), rgba(92,184,92,.02)); animation: replaceFlash 600ms ease-in-out 1 }
@keyframes replaceFlash{ from{ opacity:0 } 20%{ opacity:1 } to{ opacity:0 } }
.page-plans .meal-type{ font-weight:700; color:var(--primary-700) }
.page-plans .meal-name{ }
.page-plans .meal-meta{ color:var(--muted); font-size:.9rem }
.page-plans .meal-desc{ color: var(--muted); font-size: .9rem; margin-top: .15rem; max-height: 2.4em; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical }
.page-plans .meal-row-hover{ position:relative }
.page-plans .meal-row-hover .icon-btn{ position:absolute; right:.25rem; top:.25rem; border:1px solid var(--border); background:#fff; border-radius:999px; width:28px; height:28px; line-height:1; display:none; align-items:center; justify-content:center; cursor:pointer }
.page-plans .meal-row-hover:hover .icon-btn{ display:inline-flex }

@media (max-width: 600px){
  .page-plans .plans-header{ flex-direction:column; align-items:stretch }
  .page-plans .plans-header .right{ justify-content:space-between }
}

.muted{ color:var(--muted) }

/* Slot actions (inline editor) */
.slot-actions{ margin:.4rem 0 .2rem 0; padding:.6rem; border:1px dashed var(--border); border-radius:12px; background:#fff }
.slot-actions-head{ display:flex; align-items:center; justify-content:space-between; gap:.5rem; margin-bottom:.4rem }
.slot-title{ font-weight:800 }
.slot-actions .textarea{ margin-top:.25rem }
.slot-actions .btn{ height:36px }
@media (max-width: 720px){
  .slot-actions .grid{ grid-template-columns: 1fr } /* stack action buttons */
}

/* Floating slot popover */
.slot-overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.04) }
.slot-popover{ position:fixed; z-index:30; background:#fff; border:1px solid var(--border); border-radius:14px; box-shadow: var(--shadow-md); padding:.75rem; max-width:92vw; max-height:70vh; overflow:auto }
.right-panel-overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.05) }
.right-panel{ position:fixed; top:0; right:0; bottom:0; width:min(420px, 92vw); background:#fff; border-left:1px solid var(--border); box-shadow: var(--shadow-md); z-index:40; display:flex; flex-direction:column }
.right-panel-head{ display:flex; align-items:center; justify-content:space-between; padding:.75rem .9rem; border-bottom:1px solid var(--border) }
.right-panel-body{ padding:.9rem; overflow:auto }
.updating-banner{ display:flex; align-items:center; gap:.5rem; background: color-mix(in oklab, var(--primary) 10%, white); color:#1b4d1b; border:1px solid var(--border); border-radius:10px; padding:.5rem .6rem; font-weight:700; }
.spinner{ width:14px; height:14px; border-radius:999px; border:2px solid color-mix(in oklab, var(--primary) 60%, white); border-top-color:transparent; animation: spin 1s linear infinite }
@keyframes spin { to { transform: rotate(360deg) } }
.updating-chip{ display:inline-flex; align-items:center; gap:.35rem; background: color-mix(in oklab, var(--primary) 10%, white); color:#1b4d1b; border:1px solid var(--border); border-radius:999px; padding:.25rem .5rem; font-weight:700; font-size:.85rem }
.updated-chip{ display:inline-flex; align-items:center; background: #e6f5ea; color:#1b4d1b; border:1px solid #cfe9d6; border-radius:999px; padding:.25rem .5rem; font-weight:700; font-size:.85rem }
.slot-popover-head{ display:flex; align-items:center; justify-content:space-between; gap:.5rem; margin-bottom:.4rem }
.slot-popover .slot-title{ font-weight:800 }
.slot-popover .actions-row{ display:flex; gap:.5rem; flex-wrap:wrap; margin:.4rem 0 }
.slot-popover .refactor{ margin-top:.2rem }
.slot-popover .preview{ border:1px solid var(--border); border-radius:12px; padding:.5rem; background:#fff }
.icon-btn{ background:#fff; border:1px solid var(--border); border-radius:999px; width:28px; height:28px; display:inline-flex; align-items:center; justify-content:center; cursor:pointer }

@media (max-width: 720px){
  .slot-popover{ left:0 !important; right:0 !important; bottom:0; top:auto !important; width:auto !important; border-radius:14px 14px 0 0; padding:1rem }
}

/* Role toggle (segmented control) */
.role-toggle{ display:inline-flex; background:#fff; border:1px solid var(--border); border-radius:999px; padding:2px; box-shadow: var(--shadow-xs) }
.role-toggle .seg{ background:transparent; border:0; padding:.4rem .7rem; border-radius:999px; font-weight:700; color:var(--text); cursor:pointer }
.role-toggle .seg:hover{ background: color-mix(in oklab, var(--primary) 6%, white) }
.role-toggle .seg.active{ background: var(--gradient-brand); color:#fff }
@media (max-width: 860px){
  .role-toggle{ width:100% }
  .role-toggle .seg{ flex:1; text-align:center }
}

/* Chat page */
.page-chat .chat-header{ display:flex; align-items:flex-end; justify-content:space-between; gap:1rem; margin: .5rem 0 1rem }
.page-chat .chat-header .sub{ margin-top:.2rem }
.page-chat .chat-surface{ display:flex; flex-direction:column; gap:.6rem; min-height: 480px }
.page-chat .messages{ flex:1; overflow:auto; padding:.5rem; display:flex; flex-direction:column; gap:.6rem }
.page-chat .msg-row{ display:flex }
.page-chat .msg-row.left{ justify-content:flex-start }
.page-chat .msg-row.right{ justify-content:flex-end }
.page-chat .bubble{ max-width:min(780px, 86%); padding:.7rem .85rem; border-radius: 16px; box-shadow: var(--shadow-xs); border:1px solid var(--border) }
.page-chat .bubble.user{ background: var(--gradient-brand); color:#fff; border-color:transparent; border-bottom-right-radius: 4px }
.page-chat .bubble.assistant{ background:#fff; color:var(--text); border-bottom-left-radius: 4px }
.page-chat .bubble-content{ white-space:pre-wrap; word-wrap:anywhere }
.page-chat .composer{ display:flex; gap:.5rem; align-items:flex-end; padding:.5rem; background:#fff; border:1px solid var(--border); border-radius: 14px }
.page-chat .composer .textarea{ resize:none; min-height:44px; max-height:160px }
.page-chat .composer-actions{ display:flex; gap:.5rem }
.page-chat .typing-row{ display:flex; gap:.3rem; align-items:center; color:var(--muted); padding:.2rem .4rem }
.page-chat .typing-row .dot{ width:6px; height:6px; border-radius:999px; background: color-mix(in oklab, var(--primary) 60%, white); animation: pulse 1.3s infinite ease-in-out }
.page-chat .typing-row .dot:nth-child(2){ animation-delay: .15s }
.page-chat .typing-row .dot:nth-child(3){ animation-delay: .3s }
@keyframes pulse { 0%, 80%, 100%{ opacity:.3; transform:translateY(0) } 40%{ opacity:1; transform:translateY(-3px) } }
